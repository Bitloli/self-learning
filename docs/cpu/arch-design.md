## 如何设计一个成功的指令集架构

显然我的功力不足以真正的指导一个指令集架构的设计，感觉 10 年前是 X86 一家独大，但是如今指令集又有一种百家争鸣的感觉，工作学习中是不是和不同的指令集打交道，用这篇 blog 来整理一下自己在学习不同架构中的内容。

实现一个简单的 CPU 是不难的，如果仅仅包含运算指令，跳转指令，访存指令，其强度大约是本科生的大作业，但是能够跑起来 Linux 操作系统，就开始有点麻烦了，不过还好。
但是如果你的 CPU 可以:
- 在嵌入式平台中运行，这要求超低功耗。
- 可以在数据中心中运行，这要求虚拟化，高性能，多核。
- 可以在桌面电脑中运行，这要求视频编解码，软件生态。

这些要求让躺在 linux/arch 和 QEMU/target 下架构，除了 X86，ARM 和 RISC，大多死得悄无声息。

## 需要实现的内容

### SOC
- 主要要求实现 chipset

### 基础的库
- QEMU
- LibC

### 编译器
- LLVM / GCC
- JVM , LuaJit 和 .NET
- Rust / Golang

### Linux 内核
让 MacOS 或者 Windows 这种大公司持有的闭源操作系统支持你的新架构，可能性实在是太小了。

- 内存: page walk, cache，TLB
- ebpf
- 中断，异常
- KVM
- idle driver
- init
- perf
- vdso
- memory model
- ACPI
- 锁

### Firmware
- 主要是 edk2 的移植

## 架构设计需要考虑的点

### 物理

### 编译器
- 各种 built-in

### 加速
- SIMD 指令
- 加解密指令

### 二进制翻译
