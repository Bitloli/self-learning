# musl
website : https://www.musl-libc.org/
github mirror : https://github.com/ifduyue/musl

I came acorss musl when compiling the project firecracker. Being disgusted with glibc for years, 
I want to find a substitute for it from time to time. Glibc has too many macros, C language tricks, I bet noting will you understand with browsing the source code.
Here's simple comparison about [LOC](https://en.wikipedia.org/wiki/Source_lines_of_code) between musl and glibc

- [ ] https://news.ycombinator.com/item?id=21291893


musl
```
github.com/AlDanial/cloc v 1.82  T=0.95 s (2513.4 files/s, 193017.3 lines/s)
-------------------------------------------------------------------------------
Language                     files          blank        comment           code
-------------------------------------------------------------------------------
JSON                             1              0              0          71397
C                             1563           6612           7473          50762
C/C++ Header                   539           4513            285          33124
Assembly                       276            515            641           6532
Bourne Shell                     5            115            169            645
awk                              3             56             74            301
make                             1             68             10            159
sed                              1              0              6              9
-------------------------------------------------------------------------------
SUM:                          2389          11879           8658         162929
-------------------------------------------------------------------------------
```

glibc
```
github.com/AlDanial/cloc v 1.82  T=21.03 s (1028.0 files/s, 280970.3 lines/s)
---------------------------------------------------------------------------------------
Language                             files          blank        comment           code
---------------------------------------------------------------------------------------
D                                     4076         820632              0        1313609
DIET                                  2657         449605              0         721526
C                                     9249         115647         175829         682981
JSON                                     3              0              0         493775
C/C++ Header                          3217          40145          66415         369962
Assembly                              1828          39920          93537         234778
PO File                                 43          40870          55813         106389
Bourne Shell                            88           2037           2656          16058
make                                   207           2652           2642          12223
Python                                  52           1363           3812           8792
TeX                                      1            813           3697           7162
m4                                      55            355            167           3445
Windows Module Definition               18            190              0           2937
SWIG                                     3             12              0           2808
Verilog-SystemVerilog                    2              0              0           2748
awk                                     36            266            368           1890
Bourne Again Shell                       6            212            297           1850
C++                                     40            326            456           1382
Perl                                     4            103            165            830
Korn Shell                               1             55             68            435
yacc                                     1             56             36            290
Pascal                                   7             82            326            182
Expect                                   8              0              0             77
sed                                     11              8             15             70
Gencat NLS                               2              0              3             10
---------------------------------------------------------------------------------------
SUM:                                 21615        1515349         406302        3986209
---------------------------------------------------------------------------------------
```
Although musl's code is clean, it's impossible and laborious to inspect it line by line,
here is What I learn from it.

## What does libc involved

```sh
➜  src git:(master) ✗ for i in ./*; do
echo $i
cloc $i
done
```

- [ ] clean the code below

```
./aio Language                     files          blank        comment           code
-------------------------------------------------------------------------------
C                                3             74             45            521
./complex Language                     files          blank        comment           code
C                               68            227            814            958
./conf Language                     files          blank        comment           code
-------------------------------------------------------------------------------
C                                5             13              2            284
./crypt Language                     files          blank        comment           code
-------------------------------------------------------------------------------
C                                8            217            404           2268
./ctype Language                     files          blank        comment           code
-------------------------------------------------------------------------------
C/C++ Header                     5              0              0            764
C                               37            127             21            591
-------------------------------------------------------------------------------
./dirent Language                     files          blank        comment           code
-------------------------------------------------------------------------------
C                               12             29              0            198
C/C++ Header                     1              0              2              9
./env
      11 text files.
      11 unique files.
       0 files ignored.

github.com/AlDanial/cloc v 1.82  T=0.01 s (1645.7 files/s, 66277.0 lines/s)
-------------------------------------------------------------------------------
Language                     files          blank        comment           code
-------------------------------------------------------------------------------
C                               11             58             10            375
-------------------------------------------------------------------------------
SUM:                            11             58             10            375
-------------------------------------------------------------------------------
./errno
       3 text files.
       3 unique files.
       0 files ignored.

github.com/AlDanial/cloc v 1.82  T=0.00 s (630.2 files/s, 33613.3 lines/s)
-------------------------------------------------------------------------------
Language                     files          blank        comment           code
-------------------------------------------------------------------------------
C/C++ Header                     1             11              4             89
C                                2              8              2             46
-------------------------------------------------------------------------------
SUM:                             3             19              6            135
-------------------------------------------------------------------------------
./exit
       9 text files.
       9 unique files.
       0 files ignored.

github.com/AlDanial/cloc v 1.82  T=0.01 s (1559.2 files/s, 36555.1 lines/s)
-------------------------------------------------------------------------------
Language                     files          blank        comment           code
-------------------------------------------------------------------------------
C                                9             32             12            167
-------------------------------------------------------------------------------
SUM:                             9             32             12            167
-------------------------------------------------------------------------------
./fcntl
       6 text files.
       6 unique files.
       0 files ignored.

github.com/AlDanial/cloc v 1.82  T=0.01 s (1130.4 files/s, 23738.1 lines/s)
-------------------------------------------------------------------------------
Language                     files          blank        comment           code
-------------------------------------------------------------------------------
C                                6             16              3            107
-------------------------------------------------------------------------------
SUM:                             6             16              3            107
-------------------------------------------------------------------------------
./fenv
      28 text files.
      26 unique files.
       2 files ignored.

github.com/AlDanial/cloc v 1.82  T=0.02 s (1461.0 files/s, 74005.2 lines/s)
-------------------------------------------------------------------------------
Language                     files          blank        comment           code
-------------------------------------------------------------------------------
Assembly                        11             87             48            845
C                               15             51              2            284
-------------------------------------------------------------------------------
SUM:                            26            138             50           1129
-------------------------------------------------------------------------------
./include
      19 text files.
      19 unique files.
       0 files ignored.

github.com/AlDanial/cloc v 1.82  T=0.01 s (2736.1 files/s, 36577.4 lines/s)
-------------------------------------------------------------------------------
Language                     files          blank        comment           code
-------------------------------------------------------------------------------
C/C++ Header                    19             75              0            179
-------------------------------------------------------------------------------
SUM:                            19             75              0            179
-------------------------------------------------------------------------------
./internal
      29 text files.
      29 unique files.
       0 files ignored.

github.com/AlDanial/cloc v 1.82  T=0.01 s (2245.8 files/s, 193681.0 lines/s)
-------------------------------------------------------------------------------
Language                     files          blank        comment           code
-------------------------------------------------------------------------------
C/C++ Header                    18            279             67           1361
C                               10             79             22            684
Assembly                         1              1              0              8
-------------------------------------------------------------------------------
SUM:                            29            359             89           2053
-------------------------------------------------------------------------------
./ipc
      14 text files.
      14 unique files.
       0 files ignored.

github.com/AlDanial/cloc v 1.82  T=0.01 s (2037.6 files/s, 50938.8 lines/s)
-------------------------------------------------------------------------------
Language                     files          blank        comment           code
-------------------------------------------------------------------------------
C                               13             20              4            302
C/C++ Header                     1              5              0             19
-------------------------------------------------------------------------------
SUM:                            14             25              4            321
-------------------------------------------------------------------------------
./ldso
      39 text files.
      30 unique files.
       9 files ignored.

github.com/AlDanial/cloc v 1.82  T=0.01 s (2145.8 files/s, 37836.8 lines/s)
-------------------------------------------------------------------------------
Language                     files          blank        comment           code
-------------------------------------------------------------------------------
Assembly                        20              8             30            246
C                               10             32              0            213
-------------------------------------------------------------------------------
SUM:                            30             40             30            459
-------------------------------------------------------------------------------
./legacy
      16 text files.
      16 unique files.
       0 files ignored.

github.com/AlDanial/cloc v 1.82  T=0.01 s (2399.9 files/s, 53398.1 lines/s)
-------------------------------------------------------------------------------
Language                     files          blank        comment           code
-------------------------------------------------------------------------------
C                               16             49              3            304
-------------------------------------------------------------------------------
SUM:                            16             49              3            304
-------------------------------------------------------------------------------
./linux
      65 text files.
      65 unique files.
       0 files ignored.

github.com/AlDanial/cloc v 1.82  T=0.01 s (4677.6 files/s, 86427.8 lines/s)
-------------------------------------------------------------------------------
Language                     files          blank        comment           code
-------------------------------------------------------------------------------
C                               65            128             22           1051
-------------------------------------------------------------------------------
SUM:                            65            128             22           1051
-------------------------------------------------------------------------------
./locale
      34 text files.
      34 unique files.
       0 files ignored.

github.com/AlDanial/cloc v 1.82  T=0.02 s (1436.1 files/s, 313145.2 lines/s)
-------------------------------------------------------------------------------
Language                     files          blank        comment           code
-------------------------------------------------------------------------------
C/C++ Header                     9             33              0           5404
C                               25            199             69           1709
-------------------------------------------------------------------------------
SUM:                            34            232             69           7113
-------------------------------------------------------------------------------
./malloc
      21 text files.
      21 unique files.
       0 files ignored.

github.com/AlDanial/cloc v 1.82  T=0.01 s (1968.9 files/s, 181700.7 lines/s)
-------------------------------------------------------------------------------
Language                     files          blank        comment           code
-------------------------------------------------------------------------------
C                               18            188            118           1212
C/C++ Header                     3             56              8            356
-------------------------------------------------------------------------------
SUM:                            21            244            126           1568
-------------------------------------------------------------------------------
./math
     484 text files.
     460 unique files.
      27 files ignored.

github.com/AlDanial/cloc v 1.82  T=0.13 s (3481.5 files/s, 158932.7 lines/s)
-------------------------------------------------------------------------------
Language                     files          blank        comment           code
-------------------------------------------------------------------------------
C                              372           1653           4371          13259
Assembly                        78             35            106           1362
C/C++ Header                    10             29             39            145
-------------------------------------------------------------------------------
SUM:                           460           1717           4516          14766
-------------------------------------------------------------------------------
./misc
      39 text files.
      39 unique files.
       0 files ignored.

github.com/AlDanial/cloc v 1.82  T=0.01 s (3228.7 files/s, 145873.0 lines/s)
-------------------------------------------------------------------------------
Language                     files          blank        comment           code
-------------------------------------------------------------------------------
C                               39            200             46           1516
-------------------------------------------------------------------------------
SUM:                            39            200             46           1516
-------------------------------------------------------------------------------
./mman
      13 text files.
      13 unique files.
       0 files ignored.

github.com/AlDanial/cloc v 1.82  T=0.01 s (2227.5 files/s, 35469.4 lines/s)
-------------------------------------------------------------------------------
Language                     files          blank        comment           code
-------------------------------------------------------------------------------
C                               13             28              1            178
-------------------------------------------------------------------------------
SUM:                            13             28              1            178
-------------------------------------------------------------------------------
./mq
      10 text files.
      10 unique files.
       0 files ignored.

github.com/AlDanial/cloc v 1.82  T=0.01 s (1864.6 files/s, 35241.6 lines/s)
-------------------------------------------------------------------------------
Language                     files          blank        comment           code
-------------------------------------------------------------------------------
C                               10             23              0            166
-------------------------------------------------------------------------------
SUM:                            10             23              0            166
-------------------------------------------------------------------------------
./multibyte
      21 text files.
      21 unique files.
       0 files ignored.

github.com/AlDanial/cloc v 1.82  T=0.01 s (2767.6 files/s, 78677.8 lines/s)
-------------------------------------------------------------------------------
Language                     files          blank        comment           code
-------------------------------------------------------------------------------
C                               20             47             10            516
C/C++ Header                     1              7              5             12
-------------------------------------------------------------------------------
SUM:                            21             54             15            528
-------------------------------------------------------------------------------
./network
      79 text files.
      79 unique files.
       0 files ignored.

github.com/AlDanial/cloc v 1.82  T=0.02 s (3777.0 files/s, 169487.6 lines/s)
-------------------------------------------------------------------------------
Language                     files          blank        comment           code
-------------------------------------------------------------------------------
C                               77            339             94           2963
C/C++ Header                     2             32              8            109
-------------------------------------------------------------------------------
SUM:                            79            371            102           3072
-------------------------------------------------------------------------------
./passwd
      22 text files.
      22 unique files.
       0 files ignored.

github.com/AlDanial/cloc v 1.82  T=0.01 s (2526.1 files/s, 125614.4 lines/s)
-------------------------------------------------------------------------------
Language                     files          blank        comment           code
-------------------------------------------------------------------------------
C                               20            137             37            861
C/C++ Header                     2              9              0             50
-------------------------------------------------------------------------------
SUM:                            22            146             37            911
-------------------------------------------------------------------------------
./prng
      12 text files.
      12 unique files.
       0 files ignored.

github.com/AlDanial/cloc v 1.82  T=0.01 s (2041.1 files/s, 41502.5 lines/s)
-------------------------------------------------------------------------------
Language                     files          blank        comment           code
-------------------------------------------------------------------------------
C                               11             32              6            201
C/C++ Header                     1              1              0              4
-------------------------------------------------------------------------------
SUM:                            12             33              6            205
-------------------------------------------------------------------------------
./process
      41 text files.
      41 unique files.
       0 files ignored.

github.com/AlDanial/cloc v 1.82  T=0.01 s (3551.3 files/s, 76570.3 lines/s)
-------------------------------------------------------------------------------
Language                     files          blank        comment           code
-------------------------------------------------------------------------------
C                               34             84             22            698
Assembly                         6              2              0             66
C/C++ Header                     1              1              0             11
-------------------------------------------------------------------------------
SUM:                            41             87             22            775
-------------------------------------------------------------------------------
./regex
       7 text files.
       7 unique files.
       0 files ignored.

github.com/AlDanial/cloc v 1.82  T=0.02 s (459.1 files/s, 330514.8 lines/s)
-------------------------------------------------------------------------------
Language                     files          blank        comment           code
-------------------------------------------------------------------------------
C                                6            481            587           3740
C/C++ Header                     1             46             57            128
-------------------------------------------------------------------------------
SUM:                             7            527            644           3868
-------------------------------------------------------------------------------
./sched
      10 text files.
      10 unique files.
       0 files ignored.

github.com/AlDanial/cloc v 1.82  T=0.01 s (1855.0 files/s, 29308.7 lines/s)
-------------------------------------------------------------------------------
Language                     files          blank        comment           code
-------------------------------------------------------------------------------
C                               10             23              3            132
-------------------------------------------------------------------------------
SUM:                            10             23              3            132
-------------------------------------------------------------------------------
./search
       9 text files.
       9 unique files.
       0 files ignored.

github.com/AlDanial/cloc v 1.82  T=0.01 s (1411.8 files/s, 67139.0 lines/s)
-------------------------------------------------------------------------------
Language                     files          blank        comment           code
-------------------------------------------------------------------------------
C                                8             45             29            341
C/C++ Header                     1              3              1              9
-------------------------------------------------------------------------------
SUM:                             9             48             30            350
-------------------------------------------------------------------------------
./select
       3 text files.
       3 unique files.
       0 files ignored.

github.com/AlDanial/cloc v 1.82  T=0.00 s (679.9 files/s, 19264.9 lines/s)
-------------------------------------------------------------------------------
Language                     files          blank        comment           code
-------------------------------------------------------------------------------
C                                3              7              0             78
-------------------------------------------------------------------------------
SUM:                             3              7              0             78
-------------------------------------------------------------------------------
./setjmp
      32 text files.
      29 unique files.
       5 files ignored.

github.com/AlDanial/cloc v 1.82  T=0.02 s (1419.9 files/s, 50920.8 lines/s)
-------------------------------------------------------------------------------
Language                     files          blank        comment           code
-------------------------------------------------------------------------------
Assembly                        29             30             77            933
-------------------------------------------------------------------------------
SUM:                            29             30             77            933
-------------------------------------------------------------------------------
./signal
      69 text files.
      68 unique files.
       2 files ignored.

github.com/AlDanial/cloc v 1.82  T=0.02 s (3090.1 files/s, 55075.8 lines/s)
-------------------------------------------------------------------------------
Language                     files          blank        comment           code
-------------------------------------------------------------------------------
Assembly                        29             88              8            520
C                               39             73             17            506
-------------------------------------------------------------------------------
SUM:                            68            161             25           1026
-------------------------------------------------------------------------------
./stat
      20 text files.
      20 unique files.
       0 files ignored.

github.com/AlDanial/cloc v 1.82  T=0.01 s (2753.0 files/s, 70063.4 lines/s)
-------------------------------------------------------------------------------
Language                     files          blank        comment           code
-------------------------------------------------------------------------------
C                               20             58              0            451
-------------------------------------------------------------------------------
SUM:                            20             58              0            451
-------------------------------------------------------------------------------
./stdio
     118 text files.
     118 unique files.
       0 files ignored.

github.com/AlDanial/cloc v 1.82  T=0.03 s (4426.9 files/s, 168636.5 lines/s)
-------------------------------------------------------------------------------
Language                     files          blank        comment           code
-------------------------------------------------------------------------------
C                              116            543            116           3792
C/C++ Header                     2              4              0             40
-------------------------------------------------------------------------------
SUM:                           118            547            116           3832
-------------------------------------------------------------------------------
./stdlib
      21 text files.
      21 unique files.
       0 files ignored.

github.com/AlDanial/cloc v 1.82  T=0.01 s (2809.0 files/s, 84803.7 lines/s)
-------------------------------------------------------------------------------
Language                     files          blank        comment           code
-------------------------------------------------------------------------------
C                               21             80             34            520
-------------------------------------------------------------------------------
SUM:                            21             80             34            520
-------------------------------------------------------------------------------
./string
      85 text files.
      85 unique files.
       0 files ignored.

github.com/AlDanial/cloc v 1.82  T=0.03 s (2910.6 files/s, 91531.1 lines/s)
-------------------------------------------------------------------------------
Language                     files          blank        comment           code
-------------------------------------------------------------------------------
C                               74            182             62           1330
Assembly                        11            109            229            761
-------------------------------------------------------------------------------
SUM:                            85            291            291           2091
-------------------------------------------------------------------------------
./temp
       7 text files.
       7 unique files.
       0 files ignored.

github.com/AlDanial/cloc v 1.82  T=0.01 s (1346.7 files/s, 24240.1 lines/s)
-------------------------------------------------------------------------------
Language                     files          blank        comment           code
-------------------------------------------------------------------------------
C                                7             21              2            103
-------------------------------------------------------------------------------
SUM:                             7             21              2            103
-------------------------------------------------------------------------------
./termios
      12 text files.
      12 unique files.
       0 files ignored.

github.com/AlDanial/cloc v 1.82  T=0.01 s (2087.0 files/s, 21739.4 lines/s)
-------------------------------------------------------------------------------
Language                     files          blank        comment           code
-------------------------------------------------------------------------------
C                               12             15              1            109
-------------------------------------------------------------------------------
SUM:                            12             15              1            109
-------------------------------------------------------------------------------
./thread
     193 text files.
     191 unique files.
       4 files ignored.

github.com/AlDanial/cloc v 1.82  T=0.06 s (3380.0 files/s, 86092.5 lines/s)
-------------------------------------------------------------------------------
Language                     files          blank        comment           code
-------------------------------------------------------------------------------
C                              130            432            219           2540
Assembly                        61            117            142           1415
-------------------------------------------------------------------------------
SUM:                           191            549            361           3955
-------------------------------------------------------------------------------
./time
      40 text files.
      40 unique files.
       0 files ignored.

github.com/AlDanial/cloc v 1.82  T=0.01 s (3284.9 files/s, 155210.8 lines/s)
-------------------------------------------------------------------------------
Language                     files          blank        comment           code
-------------------------------------------------------------------------------
C                               39            157             59           1663
C/C++ Header                     1              1              0             10
-------------------------------------------------------------------------------
SUM:                            40            158             59           1673
-------------------------------------------------------------------------------
./unistd
      85 text files.
      85 unique files.
       0 files ignored.

github.com/AlDanial/cloc v 1.82  T=0.02 s (5038.5 files/s, 60936.5 lines/s)
-------------------------------------------------------------------------------
Language                     files          blank        comment           code
-------------------------------------------------------------------------------
C                               81            115              8            820
Assembly                         4              6              1             78
-------------------------------------------------------------------------------
SUM:                            85            121              9            898
-------------------------------------------------------------------------------
➜  src git:(master) ✗
```

## What you can make a reference to
- [ ] TODO
